# Unrolling of greedy weighted sparse recovery algorithms
**code TBA very soon - stay tuned!**

Codes needed to regenerate the results in the paper:

https://arxiv.org/abs/2505.15661



# Neural network unrolling of greedy weighted sparse recovery algorithms
Code used to generate the figures of the article: 
* **main paper:** [*Deep greedy unfolding: Sorting out argsorting in greedy sparse recovery algorithms*](https://arxiv.org/abs/2303.00844) by *Sina Mohammad-Taheri, Matthew J. Colbrook, and Simone Brugiapaglia*.
* [*OMP-Net: Neural network unrolling of weighted orthogonal mathcing pursuit*](https://arxiv.org/abs/2303.00844) by *Sina Mohammad-Taheri, Matthew J. Colbrook, and Simone Brugiapaglia*.

# Article's abstract
Gradient-based learning imposes (deep) neural networks to be differentiable at all steps. This includes model-based architectures constructed by unrolling iterations of an iterative algorithm onto layers of a neural network, known as algorithm unrolling. However, greedy sparse recovery algorithms depend on the non-differentiable argsort operator, which hinders their integration into neural networks. In this paper, we address this challenge in Orthogonal Matching Pursuit (OMP) and Iterative Hard Thresholding (IHT), two popular representative algorithms in this class. We propose permutation-based variants of these algorithms and approximate permutation matrices using "soft" permutation matrices derived from softsort, a continuous relaxation of argsort. We demonstrate--both theoretically and numerically--that Soft-OMP and Soft-IHT, as differentiable counterparts of OMP and IHT and fully compatible with neural network training, effectively approximate these algorithms with a controllable degree of accuracy. This leads to the development of OMP- and IHT-Net, fully trainable network architectures based on Soft-OMP and Soft-IHT, respectively. Finally, by choosing weights as "structure-aware" trainable parameters, we connect our approach to structured sparse recovery and demonstrate its ability to extract latent sparsity patterns from data.

# Python dependencies
The scripts depends on the following python packages:
* Pytorch, Matplotlib, numpy, math, sys, os

# How to use this code
## Code organization
<pre>
script directory/
|
├── main_fig_1.py
├── models/
│   ├── algs_module.py
│   ├── nnet_module.py
│
├── utils/
│   ├── data_gen.py
│   ├── my_config.py
│   ├── sort_proxy.py
│   └── train_module.py
│
├── OMP/
│   ├── main_fig_2_OMP.py
│   ├── main_fig_3_OMP.py
│   ├── data/
│       ├── fig_2/
│       └── fig_3/
│           └── checkpoints/
│   └── figs/
│       ├── fig_2/
│       └── fig_3/
│
├── IHT/
│   ├── main_fig_2_IHT.py
│   ├── main_fig_3_IHT.py
│   ├── data/
│       ├── fig_2/
│       └── fig_3/
│           └── checkpoints/
│   └── figs/
│       ├── fig_2/
│       └── fig_3/
</pre>

### models
Contains the main Matlab files used to create figures.

### utils
Contains various Matlab functions needed across main scripts.

### OMP
Contains .mat files generated by the scripts in src.

### IHT
Contains .eps files generated by the scripts in src.

#### data

#### figs

## Example
In order to generate Fig.4 in the article (Expreiment IV), you can run the following script "...\src\Fig_4\Fig_4_vis.m". This will create an image based on the previously generated data available in "...\data\Fig_4". To rerun the numerical experiments and change the settings, you can use the script "...\src\Fig_4\Fig_4.m". Please note that in order to run any of the scripts in "...\src\", you need to first change all paths in those files to appropriate locations on your end.
  
# Disclaimer
This code is provided as a complementary resource for readers and without warranty of any kind. The code may not be suitable for all purposes and the user assumes all risks associated with its use.
